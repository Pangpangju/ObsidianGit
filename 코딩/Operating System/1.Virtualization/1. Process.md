 
> [!note] 프로세스란?
> "프로세스란 ==실행중인 프로그램==이다"
> - 원래 프로그램은 생명이 없는 존재
> - 디스크 상에 존재하며 실행을 위한 명령어와 정적 데이터의 묶음

이 프로세스를 읽고 실행하여 프로그램에 생명을 불어놓는 것이 운영체제(OS)!

본디 CPU는 1개이지만 여러 프로세스가 마치 CPU가 여러개인 것처럼 실행됨, how?

$$CPU가\;여러개\;존재한다는 \;환상을 \;어떻게 \;제공하는가$$


OS 는 CPU를 ==가상화== 하여 이 문제를 해결한다. 

가상화에는 [[시분할]]이라는 기법이 사용됨

운영체제에서 CPU의 가상화를 잘 구현하기 위해 저수준의 도구 (= [[메커니즘]])과 고차원적인 "지능[^1]"이 필요함.


#### 하드웨어 상태(Machine State)
- 프로그램이 실행되는 동안 하드웨어의 상태를 읽거나 갱신할 수 있음.
- 메모리(Memory)
	- 명령어와 데이터 저장하는 공간
	- 주소 공간 (Address Space) 라고도 불림
- 레지스터(Register)
	- 프로그램 카운터 (PC)
		- 명령어 포인터 (IP)
	- 스택 포인터(Stack Pointer)
		- 현재 메모리의 스택의 제일 위를 가르킴
	- 프레임 포인터 (Frame Pointer)
		- 지금 스택의 frame의 base 를 가르킴
	- 스택, 프레임 포인터 둘다 지역 변수, 매개변수, return address 등을 저장하는데 사용

#### 프로세스 API
운영체제가 반드시 API로 제공하여야 하는 기능들:
- 생성
	- 새로운 프로세스 생성
- 제거
	- 존재하는 프로세스 제거
- 대기
	- 어떤 프로세스의 실행 중지를 대기
- 각종 제어
	- 일시정지, 재개 등 여러 기능
- 상태
	- 프로세스 상태 정보를 얻어내는 인터페이스

#### 프로세스 생성
1. 프로그램 코드와 정적 데이터를 메모리 (=프로세스의 주소공간)에 탑재(load) 하는것이다.
	-  디스크 상의 프로그램을 찾아 프로세스의 주소 공간으로 부르는 것.
2. 일정량의 메모리가 프로그램의 실행시간 스택(run-time stack) 용도로 할당됨.[^2]
3. heap 을 위한 메모리 영역을 할당
	- 동적으로 할당된 데이터를 저장
	- malloc, free 등
4. 입출력과 관련된 초기화 작업
5. 이제 `main()` 에서부터 프로그램 실행하면 됨

#### 프로세스 상태(State)
- 실행(Running)
	- 프로세서에서 실행중
- 준비 (Ready)
	- 실행될 준비중이지만 OS 가 다른 프로세스 실행하고 있는중
	- 스케줄의 여부에 따라 실행됨
- 대기(Blocked)
	- 다른 사건을 기다리는 동안 프로세스의 수행 중단.

#### 자료구조
운영체제도 일종의 프로그램이기 때문에 자료 구조를 가지고 있음.
- Process List
	- 프로세스 상태를 파악하기 위함
- Register Context
	- 프로세스가 중단되었을 때 해당 프로세스의 레지스터값을 저장함.
	- 이 레지스터값을 복원(해당 값을 실제 물리 레지스터에 다시 저장)하여 프로세스 실행을 재개


---
[^1]:  [[정책(Policy)]]
[^2]: 걍 스택 초기화 한다는 뜻 
